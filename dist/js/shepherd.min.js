!function(t,e){"function"==typeof define&&define.amd?define(["popper"],e):"object"==typeof exports?module.exports=e(require("popper")):t.Shepherd=e(t.Popper)}(this,function(t){"use strict";function e(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?o(t):e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e&&h(t.prototype,e),i&&h(t,i),t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l,p=(l=0,function(){return++l});function u(t){return void 0===t}function d(t){return"object"===a(t)}function f(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}var v=/^(.+) (top|left|right|bottom|center)$/;var y=function(){function t(){r(this,t)}return c(t,[{key:"on",value:function(t,e,i){var n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];void 0===this.bindings&&(this.bindings={}),void 0===this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:i,once:n})}},{key:"once",value:function(t,e,i){this.on(t,e,i,!0)}},{key:"off",value:function(t,e){if(void 0!==this.bindings&&void 0!==this.bindings[t])if(void 0===e)delete this.bindings[t];else for(var i=0;i<this.bindings[t].length;)this.bindings[t][i].handler===e?this.bindings[t].splice(i,1):++i}},{key:"trigger",value:function(t){if(void 0!==this.bindings&&this.bindings[t]){for(var e=arguments.length,i=Array(e>1?e-1:0),n=0,s=1;s<e;s++)i[s-1]=arguments[s];for(;n<this.bindings[t].length;){var o=this.bindings[t][n],r=o.ctx,h=o.handler,c=o.once,a=r;void 0===a&&(a=this),h.apply(a,i),c?this.bindings[t].splice(n,1):++n}}}}]),t}(),g=function(s){function h(t,n){var s;return r(this,h),(s=e(this,i(h).call(this,t,n))).tour=t,s.bindMethods(),s.setOptions(n),e(s,o(o(s)))}return n(h,y),c(h,[{key:"bindMethods",value:function(){var t=this;["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy","render"].map(function(e){t[e]=t[e].bind(t)})}},{key:"setOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.destroy(),this.id=this.options.id||this.id||"step-".concat(p());var e=this.options.when;if(e)for(var i in e)if({}.hasOwnProperty.call(e,i)){var n=e[i];this.on(i,n,this)}var s,o=JSON.stringify(this.options.buttons),r=u(o)||"true"===o,h="{}"===o||"[]"===o||"null"===o||"false"===o,c=!r&&Array.isArray(this.options.buttons),l=!r&&(null!==(s=this.options.buttons)&&"object"===a(s)&&!1===Array.isArray(s));r?this.options.buttons=[{text:"Next",action:this.tour.next,classes:"btn"}]:!h&&l?this.options.buttons=[this.options.buttons]:!h&&c||(this.options.buttons=!1)}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var t=this,e=function(t,e){if(null===t||u(t))return t;if(d(t))return t;for(var i=t.split(" "),n={},s=e.length-1,o=i.length-1;o>=0;o--){if(0===s){n[e[s]]=i.slice(0,o+1).join(" ");break}n[e[s]]=i[o],s--}return n}(this.options.advanceOn,["selector","event"]),i=e.event,n=e.selector,s=function(e){var i,s,o;t.isOpen()&&(u(n)?t.el&&e.target===t.el&&t.tour.next():(i=e.target,s=n,u(i.matches)?u(i.matchesSelector)?u(i.msMatchesSelector)?u(i.webkitMatchesSelector)?u(i.mozMatchesSelector)?u(i.oMatchesSelector)||(o=i.oMatchesSelector):o=i.mozMatchesSelector:o=i.webkitMatchesSelector:o=i.msMatchesSelector:o=i.matchesSelector:o=i.matches,o.call(i,s)&&t.tour.next()))};document.body.addEventListener(i,s),this.on("destroy",function(){return document.body.removeEventListener(i,s)})}},{key:"getAttachTo",value:function(){var t=function(t){if(d(t))return t.hasOwnProperty("element")&&t.hasOwnProperty("on")?t:null;var e=v.exec(t);if(!e)return null;var i=e[2];return"["===i[0]&&(i=i.substring(1,i.length-1)),{element:e[1],on:i}}(this.options.attachTo)||{},e=Object.assign({},t);if("string"==typeof t.element){try{e.element=document.querySelector(t.element)}catch(t){}e.element||console.error("The element for this Shepherd step was not found ".concat(t.element))}return e}},{key:"setupPopper",value:function(){if(u(t))throw new Error("Using the attachment feature of Shepherd requires the Popper.js library");var e=this.getAttachTo();e.modifiers=e.modifiers||{};var i=e.on||"right";e.positionFixed=!1,u(e.element)&&(e.element=document.body,i="top",e.modifiers=Object.assign({computeStyle:{enabled:!0,fn:function(t){return t.styles=Object.assign({},t.styles,{left:"50%",top:"50%",transform:"translate(-50%, -50%)"}),t}}},e.modifiers),e.positionFixed=!0);var n=Object.assign({},{placement:i,arrowElement:this.el.querySelector(".popper__arrow"),modifiers:e.modifiers,positionFixed:e.positionFixed},this.options.popperOptions);this.popper&&this.popper.destroy(),this.el.classList.add("shepherd-element"),this.popper=new t(e.element,this.el,n),this.target=e.element,this.target.classList.add("shepherd-enabled","shepherd-target")}},{key:"show",value:function(){var t=this;if(!u(this.options.beforeShowPromise)){var e=this.options.beforeShowPromise();if(!u(e))return e.then(function(){return t._show()})}this._show()}},{key:"_show",value:function(){var t=this;this.trigger("before-show"),this.el||this.render(),this.el.hidden=!1,this.el.style.display="block",document.body.setAttribute("data-shepherd-step",this.id),this.setupPopper(),this.options.scrollTo&&setTimeout(function(){t.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),this.el.hidden=!0,this.el.style.display="none",document.body.removeAttribute("data-shepherd-step"),this.target&&this.target.classList.remove("shepherd-enabled","shepherd-target"),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("hide")}},{key:"isOpen",value:function(){return this.el&&!this.el.hidden}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var t=this.getAttachTo().element;u(this.options.scrollToHandler)?u(t)||t.scrollIntoView():this.options.scrollToHandler(t)}},{key:"destroy",value:function(){!u(this.el)&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),delete this.el),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("destroy")}},{key:"render",value:function(){var t=this;u(this.el)||this.destroy(),this.el=f("<div class='shepherd-step ".concat(this.options.classes||"","' data-id='").concat(this.id,"' ").concat(this.options.idAttribute?'id="'.concat(this.options.idAttribute,'"'):"",">")),this.options.attachTo&&this.el.appendChild(f('<div class="popper__arrow" x-arrow></div>'));var e=document.createElement("div");e.classList.add("shepherd-content"),this.el.appendChild(e);var i=document.createElement("header");if(e.appendChild(i),this.options.title&&(i.innerHTML+="<h3 class='shepherd-title'>".concat(this.options.title,"</h3>"),this.el.classList.add("shepherd-has-title")),this.options.showCancelLink){var n=f('<a href class="shepherd-cancel-link"></a>');i.appendChild(n),this.el.classList.add("shepherd-has-cancel-link"),this.bindCancelLink(n)}if(!u(this.options.text)){var s=f("<div class='shepherd-text'></div>"),o=this.options.text;"function"==typeof o&&(o=o.call(this,s)),o instanceof HTMLElement?s.appendChild(o):("string"==typeof o&&(o=[o]),o.map(function(t){s.innerHTML+="<p>".concat(t,"</p>")})),e.appendChild(s)}if(this.options.buttons){var r=document.createElement("footer"),h=f("<ul class='shepherd-buttons'></ul>");this.options.buttons.map(function(e){var i=f("<li><a class='shepherd-button ".concat(e.classes||"","'>").concat(e.text,"</a>"));h.appendChild(i),t.bindButtonEvents(e,i.querySelector("a"))}),r.appendChild(h),e.appendChild(r)}var c=this.options.renderLocation;c?c instanceof HTMLElement?c.appendChild(this.el):"string"==typeof c&&document.querySelector(c).appendChild(this.el):document.body.appendChild(this.el),this.setupPopper(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(t){var e=this;t.addEventListener("click",function(t){t.preventDefault(),e.cancel()})}},{key:"bindButtonEvents",value:function(t,e){var i=this;for(var n in t.events=t.events||{},u(t.action)||(t.events.click=t.action),t.events)if({}.hasOwnProperty.call(t.events,n)){var s=t.events[n];"string"==typeof s&&function(){var t=s;s=function(){return i.tour.show(t)}}(),e.addEventListener(n,s)}this.on("destroy",function(){for(var i in t.events)if({}.hasOwnProperty.call(t.events,i)){var n=t.events[i];e.removeEventListener(i,n)}})}}]),h}(),b=function(t){function s(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,s),(t=e(this,i(s).call(this,n))).bindMethods(),t.options=n,t.steps=t.options.steps||[];return["complete","cancel","hide","start","show","active","inactive"].map(function(e){var i;i=e,t.on(i,function(e){(e=e||{}).tour=o(o(t)),m.trigger(i,e)})}),e(t,o(o(t)))}return n(s,y),c(s,[{key:"bindMethods",value:function(){var t=this;["next","back","cancel","complete","hide"].map(function(e){t[e]=t[e].bind(t)})}},{key:"addStep",value:function(t,e){return u(e)&&(e=t),e instanceof g?e.tour=this:("string"!=typeof t&&"number"!=typeof t||(e.id=t.toString()),e=Object.assign({},this.options.defaults,e),e=new g(this,e)),this.steps.push(e),e}},{key:"removeStep",value:function(t){for(var e=this.getCurrentStep(),i=0;i<this.steps.length;++i){var n=this.steps[i];if(n.id===t){n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1);break}}e&&e.id===t&&(this.currentStep=void 0,this.steps.length?this.show(0):this.hide())}},{key:"getById",value:function(t){for(var e=0;e<this.steps.length;++e){var i=this.steps[e];if(i.id===t)return i}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var t=this.steps.indexOf(this.currentStep);t===this.steps.length-1?(this.hide(t),this.trigger("complete"),this.done()):this.show(t+1,!0)}},{key:"back",value:function(){var t=this.steps.indexOf(this.currentStep);this.show(t-1,!1)}},{key:"cancel",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("complete"),this.done()}},{key:"hide",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){m.activeTour=null,document.body.classList.remove("shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.currentStep?this.currentStep.hide():(document.body.classList.add("shepherd-active"),this.trigger("active",{tour:this})),m.activeTour=this,t="string"==typeof e?this.getById(e):this.steps[e])if(u(t.options.showOn)||t.options.showOn())this.trigger("show",{step:t,previous:this.currentStep}),this.currentStep=t,t.show();else{var n=this.steps.indexOf(t),s=i?n+1:n-1;this.show(s,i)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),s}(),m=new y;return Object.assign(m,{Tour:b,Step:g,Evented:y}),m});